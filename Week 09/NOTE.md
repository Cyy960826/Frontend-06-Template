# 学习笔记
## HTML解析
使用FSM解析HTML主体得到DOM
### 解析标签
开始标签、结束标签、自封闭标签
### 创建元素
状态机中根据值创建标签
### 处理属性
单引号、双引号、无引号
### 构建dom树
- 开始标签入栈
- 结束标签出栈
- 自封闭节点等同于入栈后立马出栈
- 任何元素的父元素是它入栈前的栈顶
## CSS解析
### 收集CSS规则
- style 标签保存规则
- CSS Parser 分析CSS规则
- 真实情况需要考虑link/inline/body内嵌()
### 添加调用
- 当创建一个元素后，立即计算CSS
- 分析元素假设所有CSS规则全部收集完毕
- body内部的样式代码要具体分析；
### 获取父元素序列
### 选择器与元素的适配
- 选择器要从当前元素向外排列
- 复杂选择器拆成针对单个元素的选择器，用循环匹配父元素队列
### 计算选择器与元素匹配
### 生成 computed 属性
### pecificity的计算逻辑（特征、专一性）
- CSS 规则根据 specificity 和后来优先规则覆盖
- specificity 是个四元组，越左边权重越高
- 一个 CSS 规则的 specificity 根据包含的简单选择器相加而成
